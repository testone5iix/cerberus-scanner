# أداة Cerberus للفحص الأمني المتقدم

## وصف تفصيلي للأداة

**Cerberus** هي أداة متقدمة ومتخصصة في مجال التحليل الجنائي الرقمي والاستجابة للحوادث (DFIR)، مصممة للعمل على أنظمة تشغيل مايكروسوفت ويندوز. تم تطوير الأداة لتوفير قدرات فحص عميقة تتجاوز الأساليب التقليدية، بهدف كشف التهديدات الأمنية المستترة والمعقدة. تعتمد الأداة على مجموعة من الوحدات النمطية التي تعمل بشكل متوازٍ لتحقيق فحص شامل وفعال للنظام.

### القدرات الأساسية

-   **فحص النواة والبحث عن الـ Rootkits:**
    تستخدم الأداة برنامج تشغيل مخصص (`CerberusDriverHelper.sys`) للوصول إلى مستوى النواة (Kernel-level). يتيح لها هذا الوصول المتميز فحص جدول استدعاءات النظام (SSDT) للكشف عن أي عمليات اعتراض (Hooks) قد تدل على وجود Rootkit. بالإضافة إلى ذلك، تقوم بمقارنة قائمة برامج التشغيل المحملة في الذاكرة مع القوائم الرسمية للكشف عن أي برامج تشغيل مخفية أو غير موثقة.

-   **تحليل العمليات والذاكرة:**
    تقوم الأداة بتنفيذ فحص دقيق للعمليات قيد التشغيل. من خلال مقارنة نتائج واجهات برمجة التطبيقات المختلفة (مثل `CreateToolhelp32Snapshot` و `NtQuerySystemInformation`)، يمكنها تحديد العمليات التي تحاول إخفاء وجودها. كما تفحص مناطق الذاكرة المخصصة لكل عملية بحثًا عن علامات تدل على حقن الشيفرات البرمجية (Code Injection) أو تقنيات تفريغ العمليات (Process Hollowing)، حيث يتم تفريغ عملية شرعية وحقنها بشيفرة خبيثة.

-   **جمع الأدلة الجنائية للخط الزمني (Timeline Forensics):**
    عند تفعيل هذه الميزة، تقوم الأداة بجمع نسخ من القطع الأثرية الرقمية الحيوية من النظام، والتي تعتبر ضرورية في أي تحقيق جنائي رقمي. تشمل هذه الأدلة:
    * **ملف MFT ($MFT):** الجدول الرئيسي للملفات لنظام NTFS، والذي يحتوي على بيانات وصفية لجميع الملفات الموجودة على القرص.
    * **خلايا سجل ويندوز (Registry Hives):** ملفات `SAM`, `SYSTEM`, `SOFTWARE`, `SECURITY` التي تخزن تكوينات النظام والمستخدمين الحرجة.
    * **ملفات Prefetch:** تستخدمها ويندوز لتسريع إقلاع التطبيقات، ولكنها توفر للمحققين سجلاً بالتطبيقات التي تم تشغيلها.

-   **رصد الشبكة واستخبارات التهديدات:**
    توفر الأداة وحدة لمراقبة اتصالات الشبكة النشطة (TCP). عند تفعيل خيار استخبارات التهديدات، تقوم الأداة بالاستعلام عن عناوين IP الخارجية المتصل بها عبر واجهات برمجة التطبيقات (مثل VirusTotal API) لتحديد ما إذا كانت مرتبطة بأنشطة خبيثة معروفة.

-   **فحص آليات الثبات (Persistence):**
    تبحث الأداة في المواقع الشائعة التي تستخدمها البرمجيات الخبيثة لضمان استمرار عملها بعد إعادة تشغيل النظام، مع التركيز بشكل خاص على مفاتيح التشغيل التلقائي (Run/RunOnce) في سجل ويندوز.

-   **إدارة المخرجات والتقارير:**
    يتم تسجيل جميع نتائج الفحص بشكل منظم في ملف بتنسيق **JSON** (`cerberus_scan.json`)، مما يسهل عملية التحليل الآلي أو المراجعة اليدوية للنتائج.

---

## طرق الاستخدام

### المتطلبات الأساسية
1.  **صلاحيات المسؤول:** يجب تشغيل الأداة بصلاحيات المسؤول (Run as Administrator) لضمان قدرتها على الوصول إلى مكونات النظام المحمية وتحميل برنامج التشغيل المساعد.
2.  **برنامج التشغيل المساعد:** يجب أن يكون ملف `CerberusDriverHelper.sys` موجودًا في نفس المجلد الذي يوجد به الملف التنفيذي للأداة.
3.  **مفتاح API (اختياري):** لاستخدام ميزة استخبارات التهديدات، يجب تعديل الشيفرة المصدرية وإضافة مفتاح API الخاص بك لخدمة VirusTotal في متغير `apiKey`.

### خيارات التشغيل (Command-line Options)

يمكن التحكم في سلوك الأداة وتخصيص عملية الفحص من خلال وسيطات سطر الأوامر التالية:

| الخيار (Argument) | الوصف التفصيلي |
| :--- | :--- |
| `--dry-run` | يقوم بتشغيل الفحص الكامل للكشف عن التهديدات وتحديدها دون تنفيذ أي إجراءات تصحيحية مثل إنهاء العمليات المشبوهة. هذا الوضع مخصص للتقييم والتحليل فقط. |
| `--no-kill` | يقوم بالكشف عن التهديدات وتوثيقها في التقرير، ولكنه يمتنع عن إنهاء أي عمليات يُحتمل أن تكون خبيثة. مفيد في حالات التحقيق التي تتطلب بقاء البيئة على حالها. |
| `--json-log` | يقوم بتفعيل إنشاء ملف سجل شامل بتنسيق JSON (`cerberus_scan.json`) يحتوي على جميع تفاصيل الفحص، بما في ذلك معلومات النظام والتهديدات والإجراءات المتخذة. |
| `--memory-dump` | عند العثور على منطقة ذاكرة مشبوهة داخل عملية ما، يقوم هذا الخيار بتفريغ محتويات هذه المنطقة وحفظها كملف `*.dmp` في مجلد `memory_dumps/` للتحليل العميق لاحقًا. |
| `--network-scan` | يقوم بتفعيل وحدة فحص الشبكة لمراقبة جميع اتصالات TCP الصادرة وتسجيلها. |
| `--threat-intel` | يستخدم بالتزامن مع `--network-scan`. يقوم بإرسال عناوين IP الخارجية التي تم رصدها إلى خدمة استخبارات التهديدات (VirusTotal) للتحقق من سمعتها. |
| `--timeline-forensics` | يقوم بتفعيل وحدة جمع الأدلة الجنائية للخط الزمني، حيث يتم نسخ ملفات `$MFT` وسجلات ويندوز و `Prefetch` إلى مجلد `timeline_forensics/`. |

### أمثلة على الأوامر

* **لتنفيذ فحص قياسي:**
    ```bash
    cerberus.exe
    ```

* **لتنفيذ فحص شامل مخصص للاستجابة للحوادث (يوصى به):**
    ```bash
    cerberus.exe --json-log --memory-dump --network-scan --threat-intel --timeline-forensics
    ```

* **لتنفيذ فحص للكشف فقط دون إجراء أي تغيير على النظام:**
    ```bash
    cerberus.exe --dry-run --json-log
    ```

---

## المساهمة في المشروع

نرحب ترحيبًا حارًا بالمطورين ومحللي الأمن للمساهمة في تطوير وتحسين أداة Cerberus. إذا كنت ترغب في المساهمة، يرجى اتباع الإجراءات القياسية التالية:

1.  قم بإنشاء تفريع (Fork) من المستودع الأصلي إلى حسابك الخاص.
2.  قم بإنشاء فرع جديد مخصص للميزة أو الإصلاح الذي تعمل عليه (`git checkout -b feature/YourFeatureName`).
3.  قم بتنفيذ التغييرات والتحسينات المطلوبة على الكود.
4.  قم بتوثيق تغييراتك من خلال `commit` مع رسالة واضحة تصف ما قمت به.
5.  قم بدفع (Push) فرعك الجديد إلى المستودع الخاص بك على GitHub (`git push origin feature/YourFeatureName`).
6.  قم بفتح طلب سحب (Pull Request) إلى الفرع الرئيسي للمشروع الأصلي، مع تقديم وصف مفصل للتغييرات التي قمت بها وأهميتها.

---
[فتح Issue](https://github.com/testone5iix/cerberus-scanner/issues/new)


## إخلاء المسؤولية

هذه الأداة مصممة للاستخدام من قبل المتخصصين في مجال الأمن السيبراني والتحليل الجنائي الرقمي وللأغراض التعليمية والبحثية المشروعة.

-   **الاستخدام على مسؤوليتك الخاصة:** هذه الأداة تتفاعل مع مكونات حساسة وحرجة في نظام التشغيل. أي استخدام غير صحيح قد يؤدي إلى عدم استقرار النظام أو فقدان البيانات. يتحمل المستخدم المسؤولية الكاملة عن أي عواقب تنتج عن استخدام هذه الأداة.
-   **لا توجد ضمانات:** يتم توفير الأداة "كما هي" دون أي ضمانات من أي نوع، صريحة كانت أم ضمنية. لا يضمن المطورون أن الأداة ستلبي متطلباتك أو أن عملها سيكون خاليًا من الأخطاء.
-   **الالتزام القانوني:** لا يجوز استخدام هذه الأداة إلا على الأنظمة التي تمتلك تصريحًا قانونيًا وصريحًا لفحصها وتحليلها. يخلي المطورون مسؤوليتهم بالكامل عن أي استخدام غير قانوني أو غير أخلاقي لهذه الأداة.
